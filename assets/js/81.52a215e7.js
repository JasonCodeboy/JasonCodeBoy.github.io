(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{401:function(t,v,_){"use strict";_.r(v);var e=_(33),r=Object(e.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"动态注册模块，热更替功能"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#动态注册模块，热更替功能"}},[t._v("#")]),t._v(" 动态注册模块，热更替功能")]),t._v(" "),_("h3",{attrs:{id:"动态注册模块："}},[_("a",{staticClass:"header-anchor",attrs:{href:"#动态注册模块："}},[t._v("#")]),t._v(" 动态注册模块：")]),t._v(" "),_("p",[t._v("我们在 main.js 里面已经把 store 给生成好了，那这个时候我们突然发现，要去增加一个模块，怎么办呢？")]),t._v(" "),_("p",[t._v("比如说，我们使用了 Vue-Router 的异步加载功能。")]),t._v(" "),_("p",[t._v("那么我们发现有一个 store 的模块只有在异步加载的那个模块里面才要用到，其他地方根本用不到。")]),t._v(" "),_("p",[t._v("我们能不能把这部分代码，也拆分到那个异步加载的模块里面去呢？")]),t._v(" "),_("p",[t._v("Vuex 提供了这种功能，我们可以通过 store.registerModule() 来注册一个新的模块：")]),t._v(" "),_("p",[_("img",{attrs:{src:"/img/vuex-5-1.png",alt:"在这里插入图片描述"}})]),t._v(" "),_("p",[t._v("这就是动态加载模块的功能，大家有需要的时候可以去使用它。")]),t._v(" "),_("p",[t._v("然后可以看到我们在，去修改 store 代码的时候。我们会发现它都是要刷新页面去更新的。")]),t._v(" "),_("p",[t._v("这是因为我们没有进行一个热更替的功能，那么我们的开发体验就会变的比较差。")]),t._v(" "),_("p",[t._v("那么我们如何去给 Vuex 加上一个热更替的功能呢？")]),t._v(" "),_("p",[t._v("Vuex 官方是给我们提供了一套方法去做这个事情的，如下图：")]),t._v(" "),_("p",[_("img",{attrs:{src:"/img/vuex-5-2.png",alt:"在这里插入图片描述"}})]),t._v(" "),_("p",[t._v("我们可以看到，上面的代码中，我们先不直接 return，而是先 const store = new Vuex.Store()。")]),t._v(" "),_("p",[t._v("然后下面加的代码，它是 webpack 热更替功能一个普遍适用的代码。")]),t._v(" "),_("p",[t._v("只不过它要有一些 API 的支持，那么 Vuex 会有官方的 API 来支持我们的这个操作。")]),t._v(" "),_("p",[t._v("module.hot.accept 方法：")]),t._v(" "),_("p",[t._v("第一个参数是一个数组，它里面的列表就是对应我们去引用的那几个文件。")]),t._v(" "),_("p",[t._v("我们的 state，mutations，getters，actions 的地址。就和上面 import 的地址是一模一样的。")]),t._v(" "),_("p",[t._v("那么这些文件我们把它列出来之后，我们可以通过传第二个参数，来开启它的热更替功能。")]),t._v(" "),_("p",[t._v("我们要通过再次的 require 这些模块。")]),t._v(" "),_("p",[t._v("注意：在它里面，我们不能用 import，因为 import 只能写在最外层。")]),t._v(" "),_("p",[t._v("你不能在一个业务代码的逻辑里面去写 import，所以我们这边要使用 require。")]),t._v(" "),_("p",[t._v("然后 require 的时候必须要使用 default，因为我们是 export default 的这种方式 。")]),t._v(" "),_("p",[t._v("然后我们要使用 store.hotUpdate 去动态的更新我们加载过来的这些模块。")]),t._v(" "),_("p",[t._v("这样之后，我们的热更替功能就已经可以使用了。")]),t._v(" "),_("p",[t._v("那么为什么我们要写在这里，而不是写在最下面呢？")]),t._v(" "),_("p",[t._v("因为我们的 store 是在方法里面去创建的，所以我们必须每次创建一个 store 的时候，都要给这个 store 加上这个方法，不然它的热更替就没有办法生成。")]),t._v(" "),_("p",[t._v("然后我们可以再去更新修改下 getters，就可以看到页面并没有刷新就改变了，说明热更替成功了。")]),t._v(" "),_("p",[t._v("这就是给我们的 Vuex 代码加上一个热更替的功能。")]),t._v(" "),_("p",[t._v("因为我们在开发 WebApp 应用的时候，我们的状态其实是经常都在变动的。")]),t._v(" "),_("p",[t._v("如果你因为改了一下你的 actions 或者 mutations，然后整个页面刷新了。")]),t._v(" "),_("p",[t._v("那么你之前的一个修改记录就什么都没了，那么就会导致你又要去做好几步的操作去把这个状态改回来。")]),t._v(" "),_("p",[t._v("就会导致你的效率变的非常的低，那么加上这个热更替功能之后，你的效率明显就会增加很多。")]),t._v(" "),_("p",[t._v("所以大家以后在开发 Vue 项目要使用 Vuex 的时候，就可以把这个热更替的代码给它加进去。")])])}),[],!1,null,null,null);v.default=r.exports}}]);